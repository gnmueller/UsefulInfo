Writing and Reading IPTABLES:
{
iptables -t <table> -A <chain> -p <tcp,udp,icmp> --sport <sourceport> --dport <destport> -m state --state <established,related,new,invalid> -s <sourceip/subnet> -d <destip/subnet> -j <accept,drop>
	-t <table>				= Choose which table to modify rules on. Default is Filter. Can be #Filter, NAT, Mangle, Raw, or Security
	-A <chain>				= Append a rule to the specified chain,
	-p <tcp,udp,icmp>		= Choose a protocol to match
		--sport <sourceport>= Must follow the protocol match, choose a source port to match
		--dport <destport>	= Must follow the protocol match, choose a destination port to match
	-m state				= Use extended matching -m, to match states
		--state <established,related,new,invalid> = Must follow -m state, choose states to match.
	-s <sourceip/subnet>	= Choose a source IP or subnet to match
	-d <destip/subnet>		= Choose a destination IP or subnet to match
	-j <accept,drop,chain>	= Choose whether to accept, drop, or send to another chain for further processing
	\!						= Match packets that DO NOT match the following rule
	
	Tables:
		Filter & Mangle:
			Chains:
				INPUT	= Packets destined to the local system 
				OUTPUT	= Packets generated by the local system
				FORWARD	= Packets being routed through the system
		NAT:
			Chains:
				PREROUTING	= Altering packets as soon as they come in
				POSTROUTING	= Altering packets as they are departing the system
				OUTPUT		= Altering local system packets before they are routed
	
	EXAMPLES:
		#Allow ssh to and from a host with the IP 192.168.11.13
			iptables -A INPUT -s 192.168.11.13 -p tcp --dport 22 -j ACCEPT
			iptables -A OUTPUT -d 192.168.11.13 -p tcp --sport 22 -j ACCEPT
		#Allow all loopback communication
			iptables -A INPUT -i lo -j ACCEPT
			iptables -A OUTPUT -o lo -j ACCEPT
		#Allow incoming ESTABLISHED or RELATED connections on all interfaces
			iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT
		#Allow two subnets to communicate with each other freely
			iptables -A FORWARD -s 192.168.11.0/24 -d 192.168.111.112/29 -j ACCEPT
			iptables -A FORWARD -d 192.168.11.0/24 -s 192.168.111.112/29 -j ACCEPT
		#Allow communication with a DNS server at 192.0.2.2
			iptables -A OUTPUT -d 192.0.2.2 -p udp --dport 53 -j ACCEPT
		#Change default policies to DROP
			iptables -P <INPUT,OUTPUT,FORWARD,(USER DEFINED CHAIN)> DROP
		#If the incoming packet is from 192.168.111.116 and is received on interface eth2, change the source address to 198.51.199.116 
			iptables -t nat -A POSTROUTING -s 192.168.111.116 -o eth2 -j SNAT --to-source 198.51.100.116
		#Allow pings to and from 192.168.111.116
			iptables -A FORWARD -s 192.168.111.116 -p icmp -j ACCEPT
			iptables -A FORWARD -d 192.168.111.116 -p icmp -j ACCEPT
}
